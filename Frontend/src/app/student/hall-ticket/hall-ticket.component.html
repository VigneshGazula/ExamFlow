<div class="hall-ticket-page">
  <!-- Header Section -->
  <div class="page-header">
    <div class="header-content">
      <div class="icon-box">
        <span class="emoji-icon">ğŸ«</span>
        <i class="bi bi-card-checklist"></i>
      </div>
      <div>
        <h1 class="main-title">Hall Tickets</h1>
        <p class="subtitle">
          <span class="branch-badge">{{ studentBranchCode }}</span>
          <span class="separator">â€¢</span>
          <span>Year {{ studentYear }}</span>
          <span class="separator">â€¢</span>
          <span>Download your hall tickets</span>
        </p>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-wrapper">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="loading-message">Loading hall tickets...</p>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage && !isLoading" class="error-alert">
    <i class="bi bi-exclamation-triangle-fill"></i>
    <span>{{ errorMessage }}</span>
    <button type="button" class="btn-close-alert" (click)="errorMessage = ''">
      <i class="bi bi-x-lg"></i>
    </button>
  </div>

  <!-- Empty State - No Completed Exams -->
  <div *ngIf="!isLoading && !errorMessage && completedExamSeries.length === 0" class="empty-state">
    <div class="empty-icon">
      <span class="emoji-large">ğŸ“‹</span>
      <i class="bi bi-clipboard-x"></i>
    </div>
    <h3 class="empty-title">No Hall Tickets Available</h3>
    <p class="empty-text">
      Hall tickets will appear here once your exams are completed.
      <br>Check back after your exam series ends.
    </p>
  </div>

  <!-- Hall Ticket Cards Grid -->
  <div *ngIf="!isLoading && !errorMessage && completedExamSeries.length > 0" class="hall-tickets-content">
    <!-- Info Banner -->
    <div class="info-banner">
      <i class="bi bi-info-circle-fill"></i>
      <div>
        <strong>Hall Ticket Information</strong>
        <p>Download your hall tickets for completed exam series. Hall tickets are available only after being released by the administration.</p>
      </div>
    </div>

    <!-- Exam Series Cards -->
    <div class="hall-ticket-grid">
      <div *ngFor="let series of completedExamSeries" class="hall-ticket-card-wrapper">
        <div class="hall-ticket-card" [class.released]="isHallTicketReleased(series.id)">
          <!-- Status Ribbon -->
          <div class="status-ribbon" [class.released]="isHallTicketReleased(series.id)">
            <span *ngIf="isHallTicketReleased(series.id)">âœ… Released</span>
            <span *ngIf="!isHallTicketReleased(series.id)">â³ Pending</span>
          </div>

          <!-- Card Header -->
          <div class="card-header">
            <div class="header-left">
              <div class="exam-icon">
                <span *ngIf="series.examType === 1">ğŸ“–</span>
                <span *ngIf="series.examType === 2">ğŸ“</span>
                <span *ngIf="series.examType === 3 || series.examType === 4">ğŸ”¬</span>
              </div>
              <div>
                <h3 class="series-name">{{ series.name }}</h3>
                <div class="badges-row">
                  <span class="type-badge">
                    {{ getExamTypeLabel(series.examType) }}
                  </span>
                  <span class="year-badge">
                    <i class="bi bi-award"></i>
                    Year {{ series.year }}
                  </span>
                </div>
              </div>
            </div>
          </div>

          <!-- Card Body -->
          <div class="card-body">
            <!-- Exam Details -->
            <div class="detail-row">
              <div class="detail-item">
                <i class="bi bi-calendar-range"></i>
                <div>
                  <div class="detail-label">Exam Period</div>
                  <div class="detail-value">
                    {{ formatDate(series.startDate) }} - {{ formatDate(series.endDate) }}
                  </div>
                </div>
              </div>
            </div>

            <div class="detail-row">
              <div class="detail-item">
                <i class="bi bi-building"></i>
                <div>
                  <div class="detail-label">Branch</div>
                  <div class="detail-value">{{ studentBranchCode }}</div>
                </div>
              </div>

              <div class="detail-item">
                <i class="bi bi-clipboard-check"></i>
                <div>
                  <div class="detail-label">Total Exams</div>
                  <div class="detail-value">{{ series.totalExams }}</div>
                </div>
              </div>
            </div>

            <!-- Hall Ticket Status -->
            <div class="ticket-status-section">
              <div class="status-card" [class.released]="isHallTicketReleased(series.id)">
                <div class="status-icon">
                  <span *ngIf="isHallTicketReleased(series.id)">ğŸ«</span>
                  <span *ngIf="!isHallTicketReleased(series.id)">â³</span>
                </div>
                <div class="status-info">
                  <div class="status-label">Hall Ticket Status</div>
                  <div class="status-value" *ngIf="isHallTicketReleased(series.id)">
                    Released - Ready to Download
                  </div>
                  <div class="status-value pending" *ngIf="!isHallTicketReleased(series.id)">
                    Not Released Yet - Please Wait
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Card Footer -->
          <div class="card-footer">
            <!-- Download Button (Only if released) -->
            <button 
              *ngIf="isHallTicketReleased(series.id)"
              class="btn-download"
              (click)="downloadHallTicket(series)">
              <i class="bi bi-download"></i>
              <span>Download Hall Ticket</span>
              <span class="emoji-icon">ğŸ“¥</span>
            </button>

            <!-- Pending Message (If not released) -->
            <div *ngIf="!isHallTicketReleased(series.id)" class="pending-message">
              <i class="bi bi-clock-history"></i>
              <span>Hall ticket will be available once released by administration</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Statistics Section -->
    <div class="stats-section">
      <div class="stat-box">
        <div class="stat-icon total-icon">
          <span class="emoji-icon">ğŸ“š</span>
          <i class="bi bi-clipboard-data"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">{{ completedExamSeries.length }}</div>
          <div class="stat-label">Total Completed Exams</div>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon released-icon">
          <span class="emoji-icon">âœ…</span>
          <i class="bi bi-check-circle-fill"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">
            {{ releasedCount }}
          </div>
          <div class="stat-label">Hall Tickets Released</div>
        </div>
      </div>

      <div class="stat-box">
        <div class="stat-icon pending-icon">
          <span class="emoji-icon">â³</span>
          <i class="bi bi-hourglass-split"></i>
        </div>
        <div class="stat-content">
          <div class="stat-number">
            {{ pendingCount }}
          </div>
          <div class="stat-label">Pending Release</div>
        </div>
      </div>
    </div>
  </div>
</div>
